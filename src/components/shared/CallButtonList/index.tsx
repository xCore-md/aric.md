"use client";
import React from "react";
import { useOnClickOutside } from "usehooks-ts";

import { cn } from "@/lib/utils";
import { useTranslations } from "next-intl";

const PHONE_NUMBER = "+37379435990";

const getSocialButtons = () => [
  {
    href: `https://t.me/${PHONE_NUMBER}`,
    labelKey: "call.telegram",
    color: "#02B0F4",
    svgPath: (
      <path d="M24.67 5.45c-.06-.23-.14-.3-.28-.38-.32-.15-.88-.02-.88-.02s-19.89 5.1-21.06 5.76c-.25.15-.34.23-.4.34-.23.53.34.83.34.83l4.8 2.08s.18.05.26.01c1.19-.6 12.02-6.1 12.63-6.26.1-.02.16.02.14.08-.32.81-9.94 7.86-9.94 7.86s-.04.04-.06.1l-.01-.02-.93 4.88s-.34 1.5 1.31.12a42.45 42.45 0 0 1 2.83-2.13c1.6 1.33 3.31 2.81 4.04 3.56.37.38.7.47.97.49.75.04 1.04-.76 1.04-.76S24.31 8.2 24.6 6.32c.03-.18.06-.3.07-.43.02-.17.02-.35 0-.44Z" />
    ),
  },
  {
    href: `viber://chat/?number=%2B${PHONE_NUMBER.substring(1)}`,
    labelKey: "call.viber",
    color: "#7360F2",
    svgPath: (
      <>
        <path d="M8.7 6.28c.48-.25.94-.17 1.25.2.01.02.65.78.93 1.16.28.4.55.82.8 1.25.31.57.11 1.15-.2 1.4l-.63.5c-.32.26-.28.73-.28.73.01.04.95 3.55 4.43 4.44 0 0 .48.04.73-.28l.5-.63c.25-.31.83-.51 1.4-.2.43.25.85.51 1.25.8.38.28 1.16.93 1.16.93.37.31.46.77.2 1.25v.02c-.27.48-.63.91-1.04 1.28h-.01a2.06 2.06 0 0 1-1.22.53c-.15 0-.3-.02-.45-.07v-.02a15.4 15.4 0 0 1-2.92-1.34 17.37 17.37 0 0 1-3.56-2.6l-.07-.07-.04-.04-.03-.04c-.35-.35-.68-.72-.98-1.1a17.4 17.4 0 0 1-1.62-2.45A15.42 15.42 0 0 1 6.95 9h-.02a1.41 1.41 0 0 1-.06-.61c.05-.35.22-.7.52-1.07.38-.42.81-.77 1.3-1.05ZM14 5.37c1.9.05 3.5.71 4.8 1.98 1.3 1.27 1.98 3 2.03 5.12v.25a.34.34 0 0 1-.67 0v-.23c-.06-1.99-.68-3.53-1.83-4.66a6.23 6.23 0 0 0-4.35-1.78h-.2a.34.34 0 0 1 .04-.68H14Z" />
        <path d="m14.44 7.13.13.01c1.37.13 2.48.62 3.29 1.5l.07.09a4.65 4.65 0 0 1 1.12 3.26.34.34 0 0 1-.68-.01 3.96 3.96 0 0 0-1.02-2.88l-.12-.13a4.26 4.26 0 0 0-2.72-1.15h-.12l-.03-.01a.34.34 0 0 1 .05-.68h.03Z" />
        <path d="M15.01 8.96c.68.05 1.24.26 1.64.68.4.41.6.99.65 1.68v.1c0 .17-.14.31-.32.32a.34.34 0 0 1-.35-.29v-.03l-.01-.12c-.05-.55-.21-.93-.46-1.19a1.72 1.72 0 0 0-1.14-.46l-.1-.01h-.04a.34.34 0 0 1 .04-.68H15Z" />
        <path
          fillRule="evenodd"
          d="M3.94 3.32C7.4.15 14.49.58 14.49.58c6.01.02 8.71 1.98 9.38 2.6C26.1 5.1 27.32 9.37 26.5 16.1c-.8 6.55-5.73 7.18-6.6 7.46-.38.12-3.7.95-8.01.59a71.3 71.3 0 0 1-1.57 1.77c-.83.9-1.34 1.73-2.22 1.46-.7-.22-.68-1.3-.68-1.32v-2.7c-6.3-1.78-6.22-8.32-6.14-11.82.07-3.49.74-6.3 2.67-8.23Zm10.44-.85s-6.03-.4-8.95 2.26c-1.63 1.6-2.18 4-2.24 6.91-.06 2.92-.37 8.49 4.97 9.97l-.02 4.5c0 .25.03.43.18.46.1.03.26-.03.4-.16.84-.85 3.56-4.13 3.58-4.15 3.66.24 6.58-.49 6.9-.59.73-.23 4.73-.58 5.4-6.04.7-5.63-.25-9.48-2.13-11.09-.57-.51-3-2.04-8.1-2.07Z"
          clipRule="evenodd"
        />
      </>
    ),
  },
  {
    href: `https://wa.me/${PHONE_NUMBER}`,
    labelKey: "call.whatsapp",
    color: "#25D366",
    svgPath: (
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M23.3 5.06A13.01 13.01 0 0 0 2.84 20.74L1 27.48l6.89-1.8a12.96 12.96 0 0 0 6.2 1.58h.01a13.02 13.02 0 0 0 9.2-22.2Zm-9.2 20c-1.93 0-3.84-.52-5.5-1.5l-.39-.24-4.09 1.07 1.1-3.99-.26-.4a10.8 10.8 0 1 1 9.15 5.06Zm5.93-8.1c-.32-.15-1.92-.94-2.22-1.05-.3-.1-.51-.16-.73.16-.22.33-.84 1.06-1.03 1.28-.19.21-.38.24-.7.08-.33-.16-1.37-.5-2.61-1.61a9.86 9.86 0 0 1-1.8-2.25c-.2-.33-.03-.5.13-.67.15-.14.33-.38.49-.57.16-.19.22-.32.32-.54.11-.22.06-.4-.02-.57-.09-.16-.73-1.76-1-2.41-.27-.63-.53-.55-.74-.56l-.62-.01c-.21 0-.57.08-.86.4-.3.33-1.14 1.12-1.14 2.72s1.17 3.14 1.33 3.35c.16.22 2.29 3.5 5.55 4.9.77.34 1.38.54 1.85.7.78.24 1.48.2 2.04.12.63-.1 1.92-.78 2.2-1.54.26-.76.26-1.4.18-1.54-.08-.14-.3-.22-.62-.38Z"
      />
    ),
  },
];

export const CallButtonList: React.FC = () => {
  const t = useTranslations();
  const ref = React.useRef(null);
  const [show, setShow] = React.useState(false);
  const socialButtons = React.useMemo(() => getSocialButtons(), []);

  useOnClickOutside(ref, () => setShow(false));

  return (
    <div className="relative inline-block" ref={ref}>
      <button
        onClick={() => setShow(!show)}
        className={cn("flex size-12 cursor-pointer rounded-full bg-white")}
      >
        <svg
          className="fill-blue m-auto size-5.5 flex-none"
          viewBox="0 0 21 21"
        >
          <path d="M20.3 16.6c0 .37-.08.74-.25 1.1a4.58 4.58 0 0 1-2.36 2.24 5.1 5.1 0 0 1-1.99.39 8.47 8.47 0 0 1-3.3-.74 17.86 17.86 0 0 1-3.5-2.01 29.23 29.23 0 0 1-3.34-2.85c-1.05-1.06-2-2.17-2.84-3.32A18.12 18.12 0 0 1 .73 7.94 8.56 8.56 0 0 1 0 4.6c0-.69.12-1.35.37-1.96C.6 2.03 1 1.46 1.53.95A2.98 2.98 0 0 1 3.65 0c.28 0 .57.06.82.18.27.12.5.3.68.57l2.36 3.33c.18.25.32.48.4.7.1.22.15.43.15.63 0 .24-.07.49-.21.72-.13.23-.33.48-.57.72l-.77.8a.54.54 0 0 0-.17.41c0 .08.01.15.03.23l.08.2c.19.34.5.78.95 1.3.46.54.95 1.08 1.47 1.62.55.53 1.08 1.03 1.62 1.49.53.45.97.75 1.31.93l.18.09a.7.7 0 0 0 .26.04c.17 0 .3-.06.42-.18l.77-.76c.25-.25.5-.45.73-.57.23-.14.47-.21.72-.21.2 0 .4.04.62.13.23.1.46.22.71.4l3.37 2.39c.26.18.45.4.56.65.1.25.16.5.16.79Z" />
        </svg>
      </button>

      <div className="slide-up absolute top-full left-1/2 flex -translate-x-1/2 flex-col gap-2">
        {socialButtons.map((btn, index) => (
          <a
            href={btn.href}
            key={index}
            style={{
              animationDelay: `${index * 200}ms`,
              background: btn.color,
            }}
            className={cn(
              "size-0 translate-y-2 transform overflow-hidden opacity-0",
              show && "slide-up size-12 hover:!opacity-70",
              "flex rounded-full",
            )}
            target="_blank"
          >
            <svg
              className="m-auto size-6 flex-none fill-white"
              viewBox="0 0 28 28"
            >
              {btn?.svgPath}
            </svg>
            <span className="sr-only">{t(btn.labelKey)}</span>
          </a>
        ))}
      </div>
    </div>
  );
};
